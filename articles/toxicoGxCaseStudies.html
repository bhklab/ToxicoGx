<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ToxicoGx: An R Platform for Integrated Toxicogenomics Data Analysis • ToxicoGx</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ToxicoGx: An R Platform for Integrated Toxicogenomics Data Analysis">
<meta property="og:description" content="ToxicoGx">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ToxicoGx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/toxicoGxCaseStudies.html">ToxicoGx: An R Platform for Integrated Toxicogenomics Data Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ToxicoGx: An R Platform for Integrated
Toxicogenomics Data Analysis</h1>
                        <h4 data-toc-skip class="author">Sisira Kadambat
Nair</h4>
                                    <h4 data-toc-skip class="author">Esther
Yoo</h4>
                                    <h4 data-toc-skip class="author">Christopher
Eeles</h4>
                                    <h4 data-toc-skip class="author">Amy
Tang</h4>
                                    <h4 data-toc-skip class="author">Nehme
El-Hachem</h4>
                                    <h4 data-toc-skip class="author">Petr
Smirnov</h4>
                                    <h4 data-toc-skip class="author">Benjamin
Haibe-Kains</h4>
                        
      
      
      <div class="hidden name"><code>toxicoGxCaseStudies.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="plotting-gene-expression-changes-from-tg-gates-dataset">Plotting gene expression changes from TG-GATEs dataset<a class="anchor" aria-label="anchor" href="#plotting-gene-expression-changes-from-tg-gates-dataset"></a>
</h2>
<p>Our first case study is based on a plot from a paper by
Rangel-Escareño et al., in which gene expression changes of CYP1A1 (gene
associated with xenobiotic metabolism) has been plotted at all
concentrations and time points. The plot shows clear differential
expression at time 8(hr) suggesting that higher the dose, larger the
impact of CCL4 on this gene. For plotting the gene expression under same
conditions using the package, the first step is to load the datasets
from disk or download them using the downloadTSet function above. In the
following example, we use the toy dataset provided with the package to
illustrate the process. To plot, the function drugGeneResponseCurve has
been used wherein mandatory inputs such as dataset, drug name,
cell-line, molecular type, gene name, dose and time points should be
specified.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"ToxicoGx"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot time dependent dose response of Carbon tetra chloride on
CYP1A1 gene</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CoreGx</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ToxicoGx</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the tset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">TGGATESsmall</span><span class="op">)</span></span>
<span><span class="fu">ToxicoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/drugGeneResponseCurve.html">drugGeneResponseCurve</a></span><span class="op">(</span><span class="va">TGGATESsmall</span>,</span>
<span>                      duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="st">"8"</span>, <span class="st">"24"</span><span class="op">)</span>,</span>
<span>                      cell_lines <span class="op">=</span> <span class="st">"Hepatocyte"</span>, mDataTypes <span class="op">=</span> <span class="st">"rna"</span>,</span>
<span>                      features <span class="op">=</span> <span class="st">"ENSG00000140465_at"</span>,</span>
<span>                      dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Low"</span>, <span class="st">"Middle"</span>, <span class="st">"High"</span><span class="op">)</span>,</span>
<span>                      drug <span class="op">=</span> <span class="st">"Carbon tetrachloride"</span>,</span>
<span>                      ggplot_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Effect of Carbon tetra chloride on CYP1A1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      summarize_replicates <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                      <span class="op">)</span></span></code></pre></div>
<p><img src="output/figures/unnamed-chunk-2-1.png" width="768"></p>
<p><img src="CS1_published.png" width="500px"></p>
</div>
<div class="section level2">
<h2 id="connectivity-map-analysis-on-tg-gates-and-human-hepatocarcinoma-signatures">Connectivity map analysis on TG-GATEs and human hepatocarcinoma
signatures<a class="anchor" aria-label="anchor" href="#connectivity-map-analysis-on-tg-gates-and-human-hepatocarcinoma-signatures"></a>
</h2>
<p>For the second case study, we will recreate an analysis from the
paper by Jos Kleinjans et al., wherein connectivity mapping has been
used to predict compound carcinogenicity by linking in vivo human
hepatocarcinoma (HCC) signature geneset with in vitro TG-GATEs primary
human hepatocyte data. In this example, we are using the toy dataset.
The full dataset has to be downloaded to carry out the whole analysis
done in the paper. The HCC signature, already mapped to the gene level,
has been included in this package and it can be loaded by calling
data(HCC_sig). Once the dataset is loaded, recreate drug signatures for
each drug using the function drugPerturbationSig to peform statistical
modelling of the transcriptomic response to the application of each
drug. We then compare the observed up-regulated and down-regulated genes
to HCC signature published in the paper. The output will be the GSEA
connectivity score with FDR values that can be used to determine the
correlation between the two signatures.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://xtable.r-forge.r-project.org/" class="external-link">xtable</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TGGATESsmall"</span><span class="op">)</span></span>
<span><span class="co"># To compute the effect of drug concentration on the molecular profile of the cell</span></span>
<span><span class="va">drug.perturbation</span> <span class="op">&lt;-</span> <span class="fu">ToxicoGx</span><span class="fu">::</span><span class="fu"><a href="../reference/drugPerturbationSig.html">drugPerturbationSig</a></span><span class="op">(</span>tSet <span class="op">=</span> <span class="va">TGGATESsmall</span>,</span>
<span>                                         mDataType <span class="op">=</span> <span class="st">"rna"</span>,</span>
<span>                                         cell_lines <span class="op">=</span> <span class="st">"Hepatocyte"</span>,</span>
<span>                                         duration <span class="op">=</span> <span class="st">"24"</span>,</span>
<span>                                         features <span class="op">=</span> <span class="fu"><a href="../reference/ToxicoSet-accessors.html">fNames</a></span><span class="op">(</span><span class="va">TGGATESsmall</span>, <span class="st">"rna"</span><span class="op">)</span>,</span>
<span>                                         dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Low"</span><span class="op">)</span>,</span>
<span>                                         drugs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Omeprazole"</span>, <span class="st">"Isoniazid"</span><span class="op">)</span>,</span>
<span>                                         returnValues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimate"</span>,<span class="st">"tstat"</span>, <span class="st">"pvalue"</span>, <span class="st">"fdr"</span><span class="op">)</span>,</span>
<span>                                         verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">HCC_sig</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">drug.perturbation</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tstat"</span>, <span class="st">"fdr"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>             <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">HCC</span><span class="op">)</span><span class="op">{</span></span>
<span>               <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">CoreGx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/connectivityScore.html" class="external-link">connectivityScore</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                                        y <span class="op">=</span> <span class="va">HCC</span><span class="op">[</span>, <span class="fl">2</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>                                        method <span class="op">=</span> <span class="st">"fgsea"</span>, nperm<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>             <span class="op">}</span>,</span>
<span>             HCC <span class="op">=</span> <span class="va">HCC_sig</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">195</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Connectivity"</span>, <span class="st">"P Value"</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">res</span>,<span class="st">"FDR"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">res</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">'Connectivity Score results for HCC and TG-GATEs PHH gene</span></span>
<span><span class="st">       signature'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Connectivity Score results for HCC and TG-GATEs PHH gene
signature</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Connectivity</th>
<th align="right">P Value</th>
<th align="right">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Isoniazid</td>
<td align="right">-0.46017</td>
<td align="right">0.22727</td>
<td align="right">0.45454</td>
</tr>
<tr class="even">
<td align="left">Omeprazole</td>
<td align="right">0.40272</td>
<td align="right">0.77273</td>
<td align="right">0.77273</td>
</tr>
</tbody>
</table>
<p>In the above table, omeprazole showed a positive connectivity score
in contrast to isoniazid. This observation aligns with the trends
reported in the paper. The above example is to demonstrate the ease with
which drug perturbation analysis can be done using ToxicoGx package.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sisira Nair, Esther Yoo, Christopher Eeles, Amy Tang, Nehme El-Hachem, Petr Smirnov, Jermiah Joseph, Benjamin Haibe-Kains.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
